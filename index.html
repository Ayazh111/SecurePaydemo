<!DOCTYPE html>
<html lang="kk">
<head>
<meta charset="UTF-8">
<title>SecurePay Mobile</title>

<style>
body{font-family:Arial;background:#f4f6f9;padding:30px}
.container{max-width:900px;margin:auto}
.card{background:#fff;padding:20px;border-radius:10px;
box-shadow:0 5px 15px rgba(0,0,0,.1);margin-bottom:20px}
.hidden{display:none}

button{padding:10px;width:100%;margin-top:10px;
background:#2f80ed;color:#fff;border:none;border-radius:8px;cursor:pointer}

input{width:100%;padding:10px;margin:6px 0}

.error{color:red}
.notice{background:#eaf4ff;padding:10px;border-radius:8px;margin:10px 0}

.secure-indicator{
 background:#e6fff1;color:#008000;
 padding:10px;border-radius:8px;
 text-align:center;font-weight:bold;
 animation:pulse 1.2s infinite;
}

.popup{
 position:fixed;top:20px;right:20px;
 background:#2f80ed;color:#fff;
 padding:15px;border-radius:10px;display:none
}

@keyframes pulse{0%{opacity:.3}50%{opacity:1}100%{opacity:.3}}
</style>
</head>

<body>

<div class="popup" id="push"></div>

<div class="container">

<!-- SHOP -->
<div id="shop" class="card">
<h2>üõí –¢–∞—É–∞—Ä–ª–∞—Ä</h2>

<div class="secure-indicator">üîí Secure Connection (TLS 1.3)</div>

<button onclick="add('–°–º–∞—Ä—Ç—Ñ–æ–Ω',250000)">üì± –°–º–∞—Ä—Ç—Ñ–æ–Ω ‚Äî 250 000 ‚Ç∏</button>
<button onclick="add('–ù–æ—É—Ç–±—É–∫',450000)">üíª –ù–æ—É—Ç–±—É–∫ ‚Äî 450 000 ‚Ç∏</button>
<button onclick="add('“ö“±–ª–∞“õ“õ–∞–ø',80000)">üéß “ö“±–ª–∞“õ“õ–∞–ø ‚Äî 80 000 ‚Ç∏</button>

<h3>–ö–æ—Ä–∑–∏–Ω–∞: <span id="cartItems">0</span> ‚Ç∏</h3>
<button onclick="goPay()">–¢”©–ª–µ–º–≥–µ ”©—Ç—É</button>
<p id="shopErr" class="error"></p>
</div>

<!-- PAYMENT -->
<div id="pay" class="card hidden">
<h2>üí≥ “ö–∞—É—ñ–ø—Å—ñ–∑ —Ç”©–ª–µ–º</h2>

<div class="notice">üîê –ö–∞—Ä—Ç–∞ –¥–µ—Ä–µ–∫—Ç–µ—Ä—ñ —à–∏—Ñ—Ä–ª–∞–Ω“ì–∞–Ω –∂”ô–Ω–µ —Å–∞“õ—Ç–∞–ª–º–∞–π–¥—ã</div>

<input id="card" placeholder="–ö–∞—Ä—Ç–∞ –Ω”©–º—ñ—Ä—ñ (16 —Å–∞–Ω)"
       maxlength="16" inputmode="numeric" oninput="onlyDigits(this)">

<input id="exp" placeholder="MM/YY"
       maxlength="5" oninput="formatExpiry(this)">

<input id="cvv" type="password" placeholder="CVV"
       maxlength="3" inputmode="numeric" oninput="onlyDigits(this)">

<button onclick="pay()">–¢”©–ª–µ–º–¥—ñ —Ä–∞—Å—Ç–∞—É</button>
<p id="payErr" class="error"></p>
</div>

<!-- OTP -->
<div id="otp" class="card hidden">
<h2>üîî OTP —Ä–∞—Å—Ç–∞—É</h2>
<p>‚è≥ –£–∞“õ—ã—Ç: <span id="t">60</span> —Å–µ–∫</p>

<input id="otpInput" placeholder="6 —Å–∞–Ω–¥—ã –∫–æ–¥"
       maxlength="6" inputmode="numeric" oninput="onlyDigits(this)">

<button onclick="checkOTP()">–†–∞—Å—Ç–∞—É</button>

<p id="otpErr" class="error"></p>
<p id="lockMsg" class="error hidden">‚ùå 3 —Ä–µ—Ç “õ–∞—Ç–µ. –¢”©–ª–µ–º –±“±“ì–∞—Ç—Ç–∞–ª–¥—ã.</p>
</div>

<!-- SUCCESS -->
<div id="done" class="card hidden">
<h2>‚úÖ –¢”©–ª–µ–º —Å”ô—Ç—Ç—ñ ”©—Ç—Ç—ñ</h2>
<p>üì≤ Push-—Ö–∞–±–∞—Ä–ª–∞–º–∞ –∂—ñ–±–µ—Ä—ñ–ª–¥—ñ</p>
</div>

</div>

<script>
let cartTotal=0, cartList=[], otp="", tries=0, time=60, timer;

function show(id){
 document.querySelectorAll(".card").forEach(c=>c.classList.add("hidden"));
 document.getElementById(id).classList.remove("hidden");
}

// SHOP
function add(name,price){
 cartList.push(name);
 cartTotal+=price;
 cartItems.innerText=cartTotal;
}

function goPay(){
 if(cartList.length===0){
   shopErr.innerText="‚ùó –¢–∞—É–∞—Ä —Ç–∞“£–¥–∞“£—ã–∑";
   return;
 }
 show("pay");
}

// –¢–µ–∫ —Å–∞–Ω
function onlyDigits(i){
 i.value=i.value.replace(/\D/g,'');
}

// MM/YY –∞–≤—Ç–æ —Ñ–æ—Ä–º–∞—Ç
function formatExpiry(i){
 let v=i.value.replace(/\D/g,'');
 if(v.length>=3){
   i.value=v.substring(0,2)+'/'+v.substring(2,4);
 }else{
   i.value=v;
 }
}

// –ë–∏–æ–º–µ—Ç—Ä–∏—è (–∏–º–∏—Ç–∞—Ü–∏—è)
function biometric(){
 return confirm("üëÜ –ë–∏–æ–º–µ—Ç—Ä–∏—è–ª—ã“õ —Ç–µ–∫—Å–µ—Ä—ñ—Å: —Ä–∞—Å—Ç–∞—É");
}

// Luhn
function validCard(n){
 let s=0,a=false;
 for(let i=n.length-1;i>=0;i--){
   let d=parseInt(n[i]);
   if(a){d*=2;if(d>9)d-=9;}
   s+=d;a=!a;
 }
 return s%10===0;
}

// PAYMENT
function pay(){
 payErr.innerText="";
 if(!biometric()){
   payErr.innerText="–ë–∏–æ–º–µ—Ç—Ä–∏—è–ª—ã“õ —Ç–µ–∫—Å–µ—Ä—ñ—Å ”©—Ç–ø–µ–¥—ñ";
   return;
 }

 const c=card.value.trim();
 const e=exp.value.trim();
 const v=cvv.value.trim();

 if(!/^\d{16}$/.test(c)||!validCard(c)){
   payErr.innerText="–ö–∞—Ä—Ç–∞ –Ω”©–º—ñ—Ä—ñ “õ–∞—Ç–µ"; return;
 }

 if(!/^\d{2}\/\d{2}$/.test(e)){
   payErr.innerText="–ú–µ—Ä–∑—ñ–º —Ñ–æ—Ä–º–∞—Ç—ã “õ–∞—Ç–µ"; return;
 }

 let [m,y]=e.split("/").map(Number);
 let now=new Date();
 let curM=now.getMonth()+1;
 let curY=now.getFullYear()%100;

 if(m<1||m>12||y<curY||(y===curY&&m<curM)){
   payErr.innerText="–ö–∞—Ä—Ç–∞ –º–µ—Ä–∑—ñ–º—ñ ”©—Ç—ñ–ø –∫–µ—Ç–∫–µ–Ω"; return;
 }

 if(!/^\d{3}$/.test(v)){
   payErr.innerText="CVV “õ–∞—Ç–µ"; return;
 }

 // OTP
 otp=Math.floor(100000+Math.random()*900000).toString();
 tries=0; time=60;
 otpInput.value="";
 lockMsg.classList.add("hidden");

 push.innerHTML="üîî SecurePay OTP: "+otp;
 push.style.display="block";
 setTimeout(()=>push.style.display="none",5000);

 startTimer();
 show("otp");
}

function startTimer(){
 clearInterval(timer);
 timer=setInterval(()=>{
   t.innerText=time--;
   if(time<0){
     clearInterval(timer);
     otpErr.innerText="‚è∞ –£–∞“õ—ã—Ç –±—ñ—Ç—Ç—ñ";
   }
 },1000);
}

// OTP
function checkOTP(){
 if(tries>=3) return;
 if(otpInput.value===otp){
   clearInterval(timer);
   alert("üì≤ Push: –¢”©–ª–µ–º —Å”ô—Ç—Ç—ñ ”©—Ç—Ç—ñ");
   show("done");
 }else{
   tries++;
   otpErr.innerText="OTP “õ–∞—Ç–µ";
   if(tries>=3){
     lockMsg.classList.remove("hidden");
   }
 }
}
</script>

</body>
</html>
